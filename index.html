<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Minimal Notes</title>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="stylesheet" href="styles.css">
  <meta name="theme-color" content="#111827">
</head>
<body>
  <header class="app-header">
    <div class="header-title">Minimal Notes</div>
  </header>

  <main class="container">
    <!-- LIST VIEW -->
    <section id="view-list">
      <div class="composer">
        <input id="newTaskTitle" placeholder="Новая заметка... (Enter — создать)" />
        <button id="addTaskBtn" class="btn primary">Добавить</button>
      </div>
      <div id="taskList" class="cards"></div>
    </section>

    <!-- TASK DETAIL VIEW -->
    <section id="view-task" class="hidden">
      <div class="toolbar">
        <button id="backToListBtn" class="btn ghost">← К списку</button>
        <div class="toolbar-title" id="taskTitle">Заметка</div>
        <div class="toolbar-actions">
          <button id="renameTaskBtn" class="btn ghost">Переименовать</button>
          <div class="dropdown">
            <button class="btn ghost">Экспорт</button>
            <div class="dropdown-menu">
              <button id="exportTaskCompactBtn">PDF — Компактный</button>
              <button id="exportTaskDetailedBtn">PDF — Подробный</button>
            </div>
          </div>
          <button id="deleteTaskBtn" class="btn danger">Удалить</button>
        </div>
      </div>

      <div class="panel">
        <div class="panel-title">Содержимое</div>
        <div class="row gap">
          <button id="addFolderBtn" class="btn ghost">+ Папка</button>
          <button id="addSubtaskBtn" class="btn primary">+ Подзадача</button>
        </div>
        <div id="taskItems"></div>
      </div>
    </section>

    <!-- FOLDER VIEW -->
    <section id="view-folder" class="hidden">
      <div class="toolbar">
        <button id="backToTaskBtn" class="btn ghost">← К задаче</button>
        <div class="toolbar-title" id="folderTitle">Папка</div>
        <div class="toolbar-actions">
          <button id="renameFolderBtn" class="btn ghost">Переименовать</button>
          <button id="deleteFolderBtn" class="btn danger">Удалить</button>
        </div>
      </div>

      <div class="panel">
        <div class="panel-title">Подзадачи в папке</div>
        <div class="row gap">
          <button id="addSubtaskInFolderBtn" class="btn primary">+ Подзадача</button>
        </div>
        <div id="folderItems"></div>
      </div>
    </section>

    <!-- SUBTASK DETAIL -->
    <section id="view-subtask" class="hidden">
      <div class="toolbar">
        <button id="backFromSubBtn" class="btn ghost">← Назад</button>
        <div class="toolbar-title" id="subtaskTitle">Подзадача</div>
        <div class="toolbar-actions">
          <button id="renameSubtaskBtn" class="btn ghost">Переименовать</button>
          <button id="deleteSubtaskBtn" class="btn danger">Удалить</button>
        </div>
      </div>

      <div class="panel">
        <div class="panel-title">Заметка к подзадаче</div>
        <textarea id="subtaskNote" class="note" placeholder="Текст заметки..."></textarea>
        <div class="row right">
          <button id="saveSubtaskNoteBtn" class="btn primary">Сохранить заметку</button>
        </div>
      </div>

      <div class="panel">
        <div class="panel-title">Вложения</div>
        <div class="row wrap gap">
          <label class="btn ghost filelbl">
            Камера
            <input type="file" accept="image/*" capture="environment" id="attachCameraInput" hidden>
          </label>
          <label class="btn ghost filelbl">
            Фото/видео
            <input type="file" accept="image/*,video/*" id="attachGalleryInput" hidden>
          </label>
          <label class="btn ghost filelbl">
            Файл
            <input type="file" id="attachFileInput" hidden>
          </label>
        </div>
        <div id="attachments" class="attachments"></div>
      </div>
    </section>
  </main>

  <script src="idb.js"></script>
  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('./sw.js');
      });
    }
  </script>
</body>
</html>
